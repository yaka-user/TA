{% extends "base.html" %}

{% block content %}
<style>
    /* カレンダー専用スタイル */
    .day-number {
        font-weight: bold;
        margin-bottom: 0.25rem;
    }

    .table-bordered td {
        padding: 0.25rem !important;
        vertical-align: top;
        font-size: 0.8rem;
    }

    .calendar-nav h3 {
        margin: 0;
        font-size: 1.5rem;
    }

    .checkbox-list-container {
        max-height: 150px;
        overflow-y: auto;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 0.5rem;
        background-color: #fff;
    }

    /* タブ風リンク */
    .tabs {
        display: flex;
        border-bottom: 1px solid #ccc;
        margin-bottom: 1rem;
    }

    .tab-link {
        padding: 10px 15px;
        text-decoration: none;
        color: #555;
        border-bottom: 3px solid transparent;
        font-weight: bold;
    }

    .tab-link:hover {
        background-color: #f8f9fa;
        color: #000;
    }

    .tab-link.active {
        border-bottom: 3px solid #0d6efd;
        color: #0d6efd;
        background-color: #f8f9fa;
    }
</style>

<div class="row mb-3 mt-3">
    <div class="tabs">
        <a href="/" class="tab-link">リスト表示</a>
        <a href="/calendar" class="tab-link active">カレンダー表示</a>
    </div>
</div>

<div class="row mb-3 mt-3">
    <div class="col-auto">
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createModal">
            ＋ タスク作成
        </button>
    </div>
</div>

<div>
    {{ calendar_html | safe }}
</div>

<div class="modal fade" id="createModal" tabindex="-1" aria-labelledby="createModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">新しいタスクを作成</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form action="/create" method="post">
                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-12">
                            <div class="form-floating">
                                <input class="form-control" type="text" name="name" placeholder="タスク名" required>
                                <label>タスク名</label>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-floating">
                                <input class="form-control" type="datetime-local" name="deadline" required>
                                <label>締め切り日時</label>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="form-label">共有先（複数選択可）</label>
                            <div class="checkbox-list-container">
                                {% for u in followees %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="share_with" value="{{ u.id }}"
                                        id="cal_share_{{ u.id }}">
                                    <label class="form-check-label" for="cal_share_{{ u.id }}">{{ u.lastname }} {{
                                        u.firstname }}</label>
                                </div>
                                {% else %}
                                <div class="text-muted small">フォローしているユーザーがいません</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
                    <input class="btn btn-primary" type="submit" value="作成">
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // モーダル動作用のJS (タブ切り替えロジックは不要)
    // index.htmlのモーダル用スクリプトと同じものを貼り付けてください
</script>

{% endblock content %}